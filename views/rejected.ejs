<!DOCTYPE html>
<html lang="en">
<%- include('partials/head') %>
<body>
  <%- include('partials/nav') %>
  <div class="container std-vertical-padding new-message-content">
    <h2 class="page-heading">Message Rejected</h2>
    <p>Message rejected due to offensive language:
      <%
        const wholeString = `${user}, ${text}`;
        const cleanString = `${cleanUser}, ${cleanText}`;
        const censoredIndexes = wholeString.split('').map((char, i) => char !== cleanString[i]);
      %>
      <% let htmlStr = ''; %>
      <% for (let i = 0, previousCensored = false; i < wholeString.length; i++) { %>
        <% if (!previousCensored && censoredIndexes[i]) htmlStr += '<span class="bad-word">' %>
        <% if (previousCensored && !censoredIndexes[i]) htmlStr += '</span>' %>
        <% htmlStr += wholeString[i] %>
        <% if (previousCensored && i === wholeString.length - 1) htmlStr += '</span>' %>
        <% previousCensored = censoredIndexes[i] %>
      <% } %>
      <i>
        <%- htmlStr %>
      </i>
    </p>
  </div>
</body>
</html>